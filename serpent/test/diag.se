macro diag($a:$asz):
    with d = array($asz):
        with i = 0:
            while i < $asz:
                d[i] = array($asz)
                with j = 0:
                    while j < $asz:
                        if i == j:
                            d[i][j] = $a[i]
                        else:
                            d[i][j] = 0
                        j += 1
                i += 1
        d

def test_diag():
    a = [1, 3, 6, 8]
    asz = 4
    expected = [[1, 0, 0, 0], [0, 3, 0, 0], [0, 0, 6, 0], [0, 0, 0, 8]]
    actual = diag(a:asz)
    i = 0
    while i < asz:
        j = 0
        while j < asz:
            if expected[i][j] != actual[i][j]:
                return(0)
            j += 1
        i += 1
    return(1)
